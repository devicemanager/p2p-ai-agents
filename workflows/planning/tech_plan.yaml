name: Technical Planning
description: "Creates a technical plan from requirements using an AI."
steps:
  - name: "Read Requirements"
    command: 'cat {{requirements_file}}'
  - name: "Generate Plan"
    kind: ai
    command: |
      Analyze the following requirements and generate a detailed technical plan.
      Requirements: {{last_output}}
      
      After your analysis, you MUST append a JSON block defining the files to be generated.
      The JSON block must be a valid JSON array of objects.
      Each object must have:
      - "title": The title of the section.
      - "description": A brief instruction for writing this section.
      - "filename": The filename (e.g., "01_intro.md").
      
      Format the JSON block like this:
      ```json
      [
        {"title": "Executive Summary", "description": "High-level overview...", "filename": "01_exec_summary.md"}
      ]
      ```
    output_var: tech_plan_with_json

  - name: "Extract Task List"
    kind: ai
    command: |
      Extract ONLY the JSON array from the following text. Do not include any explanation or markdown formatting outside the JSON structure.
      
      Text:
      {{tech_plan_with_json}}
    output_var: planned_tasks_json

  - name: "Save Plan to File"
    kind: save_to_file
    command: "{{output_path}}"

